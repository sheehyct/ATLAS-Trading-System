# ATLAS Crypto Monitoring - Session Startup

**Current Session:** CRYPTO-MONITOR-3
**Last Session:** CRYPTO-MONITOR-2 (December 21, 2025)
**Focus:** Monitor daemon for correct trigger timing after stale setup fix

---

## Session Objective

Monitor the crypto daemon to verify fixes from CRYPTO-MONITOR-2:
1. Triggers now fire at correct time (not days late)
2. Multiple positions can execute (position limit removed)
3. Stale 3-? setups no longer persist after pattern completes
4. Continue trade accuracy auditing with more data

---

## Quick Start Commands

```bash
# Check daemon is running
ssh atlas@178.156.223.251 "sudo systemctl status atlas-crypto-daemon --no-pager | head -15"

# Start monitoring logs
ssh atlas@178.156.223.251 "sudo journalctl -u atlas-crypto-daemon -f --no-pager"

# Get recent signals
ssh atlas@178.156.223.251 "sudo journalctl -u atlas-crypto-daemon --since '10 minutes ago' --no-pager | grep 'NEW SIGNAL'"

# Check current setups (should only show CURRENT bar setups, not stale ones)
ssh atlas@178.156.223.251 "cd ~/vectorbt-workspace && source .venv/bin/activate && python3 -c '...' "
```

---

## Critical: Invoke strat-methodology Skill

**MANDATORY** for any STRAT pattern analysis.

---

## Bugs Fixed in CRYPTO-MONITOR-2

### 1. Stale 3-? Setups - FIXED

**Status:** RESOLVED (commit 04fbebb)

Root cause: 3-? setup validation used `pass` (never invalidated).
Fix: Now invalidates when any subsequent bar breaks the range.

Before: 5 weekly setups including from Nov 2 (7 weeks old!)
After: Only 1 setup from current bar

### 2. One-Position-Per-Symbol Limit - REMOVED

**Status:** RESOLVED (commit 04fbebb)

Daemon now allows multiple positions per symbol for better data collection.

---

## What to Watch For

### Good Signs (Fix Working):
- 3-? setups only from CURRENT bars (not weeks old)
- Triggers firing within minutes of pattern completion, not days later
- Multiple trades executing when valid signals fire
- Entry prices matching trigger levels

### Warning Signs (Potential Issues):
- Setups from old bars still appearing
- Trades executing days after pattern completion
- Pattern-direction mismatches (e.g., "3-2D LONG")

---

## Event Response Protocol

### When NEW SIGNAL [SETUP] appears:
1. Check setup bar timestamp - should be recent (current bar)
2. If old timestamp, investigate why stale setup persists

### When TRIGGER FIRED appears:
1. Note trigger vs current price
2. Verify this is a CURRENT pattern trigger, not stale

### When TRADE OPENED appears:
1. Verify entry price is near trigger level
2. Check pattern/direction makes sense per STRAT
3. Note: Multiple trades per symbol are now allowed

---

## Reference Documents

| Document | Purpose |
|----------|---------|
| `docs/CRYPTO_HANDOFF.md` | Session handoff for crypto monitoring |
| `docs/HANDOFF.md` | Equity work (separate stream) |
| `~/.claude/skills/strat-methodology/` | STRAT rules reference |

---

## Symbols Being Monitored

| Symbol | Description |
|--------|-------------|
| BIP-20DEC30-CDE | Bitcoin derivative (Dec 30 expiry) |
| ETP-20DEC30-CDE | Ethereum derivative (Dec 30 expiry) |

---

## Session End Protocol

1. Update `docs/CRYPTO_HANDOFF.md` with findings
2. Update this file for next session
3. Store summary in OpenMemory (tag: CRYPTO-MONITOR)
4. Provide chat summary

---

## Session History

### CRYPTO-MONITOR-2 (Dec 21, 2025) - COMPLETE
- Fixed stale 3-? setup bug (setups never invalidated)
- Removed one-position-per-symbol limit
- Verified fix: stale setups from Nov 2 and Dec 7 now removed
- Commit: 04fbebb

### CRYPTO-MONITOR-1 (Dec 21, 2025) - COMPLETE
- Fixed signal expiration bug (detected_time used bar timestamp)
- Fixed signal deduplication (signal_id used detected_time)
- Deployed to VPS, signals now persist
- Commit: ad62441

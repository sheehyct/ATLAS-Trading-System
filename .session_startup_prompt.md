# Session 21 Startup Prompt - ATLAS Phase F Validation

## Context: Session 20 COMPLETED Documentation Pivot

**Session 20 Summary:** Documentation pivot session - NO CODE CHANGES
- Multi-layer integration architecture defined (ATLAS + STRAT + Options)
- Capital requirements explicitly documented ($3k options vs $10k+ equities)
- Old STRAT system failure analysis completed (root cause: superficial VBT integration)
- Development approach confirmed (sequential: finish ATLAS Phase F, then STRAT integration)
- Core documentation updated (HANDOFF.md, CLAUDE.md, System Architecture Reference)

**All 6 Phases A-E Status:**
- Phase A (Features): COMPLETE - 16/16 tests passing
- Phase B (Optimization): COMPLETE - 6/6 tests passing
- Phase C (Cross-validation): COMPLETE - 9/9 tests passing
- Phase D (Online inference): COMPLETE - March 2020 100% bear detection
- Phase E (Regime mapping): COMPLETE - March 2020 100% CRASH+BEAR detection
- **Phase F (Validation): NEXT - 7 comprehensive validation tests**

---

## MANDATORY First Steps

1. **Read HANDOFF.md** - Session 20 summary at top + multi-layer architecture sections
2. **Read CLAUDE.md** - NEW section: "STRAT Integration Development Rules"
3. **Query OpenMemory** for context:
   ```
   - "Session 20 documentation pivot multi-layer integration"
   - "Capital requirements $3k options vs $10k equities"
   - "Old STRAT system failure root cause VBT integration"
   ```

---

## Session 21 Priority: ATLAS Phase F - Comprehensive Validation

### Objective:

Implement comprehensive validation suite to verify Academic Jump Model performance across multiple dimensions and time periods.

### Implementation Plan:

**Create Validation Test Suite:**

File: `tests/test_regime/test_academic_validation.py` (500+ lines estimated)

Seven comprehensive validation tests:

**Test 1: March 2020 Crash Timeline Validation**
- Verify regime sequence: Feb 2020 TREND_BULL → Early Mar TREND_BEAR → Mid Mar CRASH → Late Mar TREND_BEAR
- Check specific circuit breaker days (March 12, 16, 18) detected as CRASH
- Validate feature values during crash period (DD > 0.02, Sortino_20 < -0.15)
- Success: Timeline matches historical crash sequence

**Test 2: Multi-Year Regime Distribution**
- 2016-2024 full dataset regime distribution analysis
- No regime should dominate >60% (prevent degenerate solutions)
- All 4 regimes should appear (minimum 5% each, except CRASH can be rare <5%)
- Success: Balanced regime distribution, no optimizer degeneracy

**Test 3: Regime Persistence (No Thrashing)**
- Annual regime switches should be 0.5-2.0 (not excessive)
- Temporal penalty working correctly (lambda=15 for trading)
- No daily regime flip-flopping (minimum regime duration >= 5 days)
- Success: Stable regimes, reasonable switch frequency

**Test 4: Bull Market Detection (2017-2019)**
- TREND_BULL should dominate during sustained bull markets
- >50% TREND_BULL during 2017-2018 period (known bull market)
- Minimal CRASH days during stable periods (<1%)
- Success: Correctly identifies extended bull market periods

**Test 5: Feature-Regime Correlation**
- CRASH days should have high DD (>0.02) AND negative Sortino (<-0.15)
- TREND_BULL days should have positive Sortino (>0.3)
- TREND_BEAR days should have negative Sortino (<0.0)
- TREND_NEUTRAL days should have moderate Sortino (0 to 0.3)
- Success: Features correlate with regime labels (validates mapping logic)

**Test 6: Parameter Sensitivity**
- Test different lambda values (5, 15, 50)
- Lower lambda → more regime switches (verified)
- Higher lambda → fewer switches but may miss rapid changes
- Lambda=15 optimal for trading (from Phase D findings)
- Success: Lambda parameter behaves as expected from academic paper

**Test 7: Online vs Static Consistency**
- Compare online_inference() vs static fit() on same data
- Results should be consistent (not identical due to lookback differences)
- Verify no algorithmic bugs in online implementation
- Success: Online matches static within reasonable tolerance (±10% regime agreement)

---

### Performance Metrics Validation:

Implement helper functions to calculate:
- Sharpe ratio improvement vs buy-and-hold
- Maximum drawdown reduction
- Volatility reduction
- Win rate of regime predictions

Target metrics (from academic paper):
- Sharpe improvement: +20% to +42%
- MaxDD reduction: ~50%
- Volatility reduction: ~30%

---

### Success Criteria for Session 21:

**MANDATORY for completion:**
- [ ] 7 validation tests implemented
- [ ] All tests passing (or documented failures with explanations)
- [ ] Performance metrics calculated and documented
- [ ] March 2020 timeline verified (Feb bull → Early Mar bear → Mid Mar crash → Late Mar bear)
- [ ] Multi-year regime distribution validated (no degenerate solutions)
- [ ] README.md updated with validation results
- [ ] HANDOFF.md updated with Phase F completion status
- [ ] Professional git commit (no emojis, plain ASCII)

**If Phase F completes in <2-3 hours:**
- Begin planning STRAT Phase 1 implementation
- Review Claude Desktop Layer Proposals for STRAT bar classification approach
- NO CODE yet - planning only after Phase F validation complete

---

## Key Reference Files

**Implementation:**
- `regime/academic_jump_model.py`: Complete implementation (Phases A-E)
- `regime/academic_features.py`: Feature calculation
- `regime/base_regime_detector.py`: Abstract base class

**Existing Tests (Reference for Test 7 comparison):**
- `tests/test_regime/test_academic_features.py`: Phase A tests (16 tests)
- `tests/test_regime/test_academic_jump_model.py`: Phase B tests (6 tests)
- `tests/test_regime/test_lambda_crossval.py`: Phase C tests (9 tests)
- `tests/test_regime/test_online_inference.py`: Phase D tests (7 tests)
- `tests/test_regime/test_regime_mapping.py`: Phase E tests (8 tests)

**NEW File to Create:**
- `tests/test_regime/test_academic_validation.py`: Phase F tests (7 tests)

**Documentation:**
- `docs/HANDOFF.md`: Session 20 summary + multi-layer architecture (UPDATED)
- `docs/CLAUDE.md`: STRAT integration development rules (UPDATED)
- Academic paper: `C:\Users\sheeh\Downloads\JUMP_MODEL_APPROACH.md`

---

## Capital Requirements Context (From Session 20):

**ATLAS Equity Strategies:**
- Minimum Viable Capital: $10,000 (full position sizing)
- With $3,000: CAPITAL CONSTRAINED, sub-optimal performance
- Recommendation: Paper trade ATLAS with $10k simulated while building real capital

**STRAT + Options Strategies:**
- Minimum Viable Capital: $3,000 (explicitly designed for this)
- Capital Efficiency: 27x better than equities at $3k level
- Recommendation: Deploy live with $3k after STRAT integration complete

**User Preference:** $3,000 starting capital (risk management, not undercapitalization)

**Deployment Plan (Post-Integration):**
- ATLAS: Paper trade with $10k simulated (validate regime detection)
- STRAT + Options: Live paper or small live with $3k (test capital-efficient execution)
- Duration: 3 months (60% probability of regime change for validation)

---

## Multi-Layer Architecture Quick Reference:

```
Layer 1 (ATLAS): Regime Detection - COMPLETE (Phase F validation next)
└── Output: TREND_BULL, TREND_BEAR, TREND_NEUTRAL, CRASH

Layer 2 (STRAT): Pattern Recognition - PENDING (Sessions 22-27 estimated)
└── Output: Entry price, stop price, magnitude target, pattern confidence

Layer 3 (Execution): Capital-Aware Deployment - PENDING (Sessions 28-30 estimated)
└── Options (optimal $3k) OR Equities (optimal $10k+)

Integration: ATLAS regime filters STRAT signals (confluence model)
Timeline: 3-4 weeks to paper trading deployment (realistic estimate)
```

---

## Expected Timeline

**Phase F Implementation:** 2-3 hours
- Design validation tests: 30 min
- Implement 7 test cases: 1.5 hours
- Run full validation suite: 30 min
- Document results and update README: 30 min

**Session 21 Goal:** Complete Phase F, Academic Jump Model FULLY VALIDATED and ready for integration into multi-layer ATLAS+STRAT system

---

## Remember:

**Phase E is COMPLETE and VALIDATED!** March 2020 detection working at 100% CRASH+BEAR (exceeds >50% target).

Now we implement comprehensive validation suite (Phase F) to verify the Academic Jump Model across multiple dimensions: timeline validation, regime distribution, persistence, feature correlation, parameter sensitivity, and consistency checks.

After Phase F completes, we have a VALIDATED Layer 1 (ATLAS regime detection) ready to integrate with Layer 2 (STRAT pattern recognition) and Layer 3 (capital-aware execution).

**Good luck with Phase F - the final validation phase!**

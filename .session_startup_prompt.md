# Session Startup Prompt - EQUITY-89

**Previous Session:** EQUITY-88 (January 24, 2026)
**Current Branch:** `main`
**VPS Status:** Running - deployed 06ab6f8, 3-? target fix active
**Plan Mode:** OFF (implementation ready)

---

## EQUITY-88 Accomplishments

1. **Completed Phase 3.1 - ExecutionCoordinator Extraction**
   - Created `strat/signal_automation/coordinators/execution_coordinator.py` (560 lines)
   - Extracted: execute_triggered_pattern(), execute_signals(), is_intraday_entry_allowed(), reevaluate_tfc_at_entry()
   - Protocol classes for dependency injection (TFCEvaluator, PriceFetcher)

2. **Wired ExecutionCoordinator to Daemon**
   - Added _setup_execution_coordinator() method
   - Replaced 5 methods with delegation calls
   - daemon.py reduced: 1,849 -> 1,512 lines (-337 lines)

3. **Added 48 New Tests**
   - Created `tests/test_signal_automation/test_coordinators/test_execution_coordinator.py`
   - Coverage: initialization, price fetching, intraday timing, TFC re-eval, triggered patterns

4. **Fixed TFC Re-eval Tests**
   - Updated fixture to set coordinator's TFC evaluator
   - All 1,004 signal automation tests passing

---

## EQUITY-89 Priorities

### Priority 1: Continue Phase 3 - StaleSetupValidator Extraction

Extract StaleSetupValidator from SignalDaemon:
- Source: Lines 774-873 (~100 lines)
- New file: `strat/signal_automation/coordinators/stale_setup_validator.py`
- Methods: `is_setup_stale()`, staleness window calculations by timeframe
- Write 20+ tests
- This will get daemon.py under 1,500 lines

### Priority 2: Phase 4 - PositionMonitor Extractions

After StaleSetupValidator, begin PositionMonitor god class refactoring:
- 4.1 ExitConditionEvaluator (Lines 619-836)
- 4.2 TrailingStopManager (Lines 856-1084)
- 4.3 PartialExitManager (Lines 1085-1134)

### Priority 3: Code Review

- Run `/code-review` on Phase 3 extractions

---

## Phase 4 Summary

| Phase | Coordinator | Lines | Tests | Status |
|-------|-------------|-------|-------|--------|
| 1.1 | AlertManager | 254 | 22 | COMPLETE |
| 1.2 | HealthMonitor | 291 | 30 | COMPLETE |
| 1.3 | MarketHoursValidator | 298 | 41 | COMPLETE |
| 2.1 | FilterManager | 401 | 59 | COMPLETE |
| 3.1 | ExecutionCoordinator | 560 | 48 | COMPLETE |
| 3.2 | StaleSetupValidator | TBD | TBD | PENDING |
| **Total** | - | **1,804** | **200** | |

### daemon.py Progress

- Start: 2,042 lines (EQUITY-84)
- Current: 1,512 lines
- Goal: <1,500 lines (-12 more needed)

---

## Reference Documents

- HANDOFF: `docs/HANDOFF.md`
- CLAUDE.md: `docs/CLAUDE.md` (STRICT COMPLIANCE)
- Phase 4 Plan: `C:\Users\sheeh\.claude\plans\transient-percolating-mist.md`

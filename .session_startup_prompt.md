# Session Startup Prompt - EQUITY-62

**Previous Session:** EQUITY-61 (January 13, 2026)
**Current Branch:** `main`
**VPS Status:** Needs deployment of EQUITY-61 intrabar fix
**Plan Mode:** ON (TFC architecture overhaul)

---

## EQUITY-61 Status: COMPLETE

**Critical Bug Fixed:**
- Intrabar tracking used OPTION price instead of underlying stock price
- Caused false Type 3 pattern invalidations
- Commit: ee3771c

**TFC Audit Complete:**
- Found 4 major issues preventing proper TFC filtering
- Trades entering against timeframe continuity

---

## Priority 1: TFC Architecture Overhaul (CRITICAL)

**Why trades are losing:** TFC is calculated but NOT used to filter signals.

### Issues to Fix

| Issue | File:Line | Current | Should Be |
|-------|-----------|---------|-----------|
| 4H Missing | paper_signal_scanner.py:130 | `['1H', '1D', '1W', '1M']` | `['1M', '1W', '1D', '4H', '1H']` |
| No TFC Filter | daemon.py:714-793 | Not checked | Add to `_passes_filters()` |
| Weak Threshold | config.py:275 | `min_strength=2` | `min_strength=3` |
| Bad Default | daemon.py:959 | `else True` | `else False` |

### Implementation Steps

1. Add 4H to DEFAULT_TIMEFRAMES
2. Add TFC filter in `_passes_filters()`:
   - 1H patterns: require min 3/4 TFC (75%)
   - 1D patterns: require min 2/3 TFC (67%)
3. Raise `tfc_reeval_min_strength` from 2 to 3
4. Change missing TFC default from True to False

---

## Priority 2: Equity Prioritization (HIGH)

When multiple signals fire, rank by ATR + Volume:
- Higher ATR% = faster moves for options
- Higher volume = better liquidity/fills
- Priority score: `ATR% * volume_ratio`

---

## Priority 3: Deploy to VPS (MEDIUM)

```bash
ssh atlas@178.156.223.251
cd ~/vectorbt-workspace && git pull
sudo systemctl restart atlas-daemon
```

---

## Reference Documents

- HANDOFF: `docs/HANDOFF.md`
- CLAUDE.md: `docs/CLAUDE.md` (STRICT COMPLIANCE)
- STRAT Skill: `C:/Users/sheeh/.claude/skills/strat-methodology/`
- Session Archive: `docs/session_archive/`
